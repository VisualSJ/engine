CCEFFECT {
  techniques: [
    {
      queue: opaque
      lod: 100
      passes: [
        {
          vert: line-vs:vert
          frag: line-fs:frag
          depthStencilState: {
            depthTest: true
            depthWrite: false
          }
        }
      ]
    }
  ]
}

CCPROGRAM line-vs {
  precision mediump float;
  in vec3 a_position;
  in vec3 a_color;

  #include <cc-local>
  #include <cc-global>

  out vec3 color;

  vec4 vert () {
    vec4 pos = cc_matViewProj * cc_matWorld * vec4(a_position, 1);

    // // halp-pixel offset solution 1
    // vec4 pos = cc_matViewProj * cc_matWorld * vec4(
    //   floor(a_position.x) + 0.5,
    //   floor(a_position.y) + 0.5,
    //   a_position.z,
    //   1
    // );

    // halp-pixel offset solution 2
    // vec2 hpc = vec2(screen.x * 0.5, screen.y * 0.5);
    // vec4 pos = cc_matViewProj * cc_matWorld * vec4(a_position, 1);
    // pos = vec4(
    //   2.0 * ((floor((pos.x + 1.0) * 0.5 * screen.x) + 0.5) / screen.x - 0.5),
    //   2.0 * ((floor((pos.y + 1.0) * 0.5 * screen.y) - 0.5) / screen.y - 0.5),
    //   pos.z,
    //   pos.w
    // );

    color = a_color;

    return pos;
  }
}

CCPROGRAM line-fs {
  precision mediump float;
  in vec3 color;

  vec4 frag () {
    return vec4(color, 1.0);
  }
}
